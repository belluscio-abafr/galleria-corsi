{{ define "main" }}
<div class="projects-container">
    <article class="category-page-intro">
        <!-- Navigation tra tutte le categorie -->
        <div class="category-filter-simple">
            <label>Filtra per tipologia:</label>
            <div class="tags-list">
                {{ $currentCategory := .Data.Term }}
                {{ $allCategories := slice }}
                {{ range site.RegularPages }}
                    {{ if eq .Section "progetti" }}
                        {{ range .Params.categories }}
                            {{ $allCategories = $allCategories | append . }}
                        {{ end }}
                    {{ end }}
                {{ end }}
                {{ range ($allCategories | uniq | sort) }}
                    {{ if eq . $currentCategory }}
                        <span class="tag-link tag-active">{{ . | title }}</span>
                    {{ else }}
                        <a href="/categories/{{ . | urlize }}/" class="tag-link">{{ . | title }}</a>
                    {{ end }}
                {{ end }}
            </div>
        </div>
    </article>

    <!-- Griglia dei progetti con questa categoria -->
    <section class="projects-grid">
        {{ if .Pages }}
            {{ range .Pages }}
                {{ $project := . }}
                <article class="project-card">
                    <a href="{{ .RelPermalink }}" class="project-link">
                        {{ with .Params.copertina }}
                            <div class="project-image">
                                <img src="{{ $project.RelPermalink }}{{ . }}" alt="{{ $project.Params.titolo | default $project.Title }}" loading="lazy">
                            </div>
                        {{ end }}
                        <div class="project-info">
                            <h3 class="project-title">{{ .Params.titolo | default .Title }}</h3>
                            <p class="project-student">{{ .Params.studente }}</p>
                            <p class="project-description">{{ .Params.descrizione | truncate 150 }}</p>
                        </div>
                    </a>
                </article>
            {{ end }}
        {{ else }}
            <p>Non ci sono progetti di questa tipologia.</p>
        {{ end }}
    </section>
</div>
{{ end }}
